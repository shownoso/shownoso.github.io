(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{210:function(s,a,t){"use strict";t.r(a);var n=t(0),e=Object(n.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"travis-ci"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#travis-ci"}},[s._v("#")]),s._v(" Travis CI")]),s._v(" "),t("p",[s._v("一个提供持续集成服务，用于测试和部署的自动化的工具。")]),s._v(" "),t("h2",{attrs:{id:"主要流程"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#主要流程"}},[s._v("#")]),s._v(" 主要流程")]),s._v(" "),t("ul",[t("li",[s._v("将 github 中的仓库信息同步到 Travis CI，当满足任务触发条件时，Travis 将在虚拟容器中执行仓库根目录下的 "),t("code",[s._v(".travis.yml")]),s._v(" 中配置的任务。")]),s._v(" "),t("li",[s._v("需要允许 Travis 对目标服务器的访问。因此，对于远程服务器需要配置"),t("RouterLink",{attrs:{to:"/blog/SSH_Login.html"}},[s._v("免密登录")]),s._v("，而对于 github 的访问，需要指定一个 "),t("code",[s._v("github_token")]),s._v("。")],1)]),s._v(" "),t("h3",{attrs:{id:"准备工作"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#准备工作"}},[s._v("#")]),s._v(" 准备工作")]),s._v(" "),t("ol",[t("li",[s._v("使用 github 账号登录 "),t("a",{attrs:{href:"https://www.travis-ci.org/",target:"_blank",rel:"noopener noreferrer"}},[s._v("Travis CI"),t("OutboundLink")],1),s._v("；")]),s._v(" "),t("li",[s._v("选择需要同步到 Travis 的 github 仓库；")]),s._v(" "),t("li",[s._v("在 settings（More options） 面板中进行指定项目的配置：\n"),t("ul",[t("li",[s._v("General：选择触发任务的时机，比如勾选 Build pushed branches 表示推送时触发构建")]),s._v(" "),t("li",[s._v("Environment Variables：设置执行任务时容器的环境变量")])])])]),s._v(" "),t("h3",{attrs:{id:"配置文件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#配置文件"}},[s._v("#")]),s._v(" 配置文件")]),s._v(" "),t("p",[s._v("在根目录下创建 "),t("code",[s._v(".travis.yml")]),s._v("，通过该配置文件告知 travis 需要执行的具体任务。")]),s._v(" "),t("h2",{attrs:{id:"github-pages-示例"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#github-pages-示例"}},[s._v("#")]),s._v(" Github Pages 示例")]),s._v(" "),t("p",[s._v("一个 github pages "),t("a",{attrs:{href:"https://docs.travis-ci.com/user/deployment/",target:"_blank",rel:"noopener noreferrer"}},[s._v("快捷部署"),t("OutboundLink")],1),s._v("的参考配置：")]),s._v(" "),t("div",{staticClass:"language-yml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("language")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" node_js\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("node_js")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" lts/*\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("install")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" npm install \n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("script")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" npm run docs"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("build\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("deploy")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("provider")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" pages "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 部署到 github pages， 会自动创建 gh-pages 分支")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("skip_cleanup")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean important"}},[s._v("true")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("local_dir")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" docs/.vuepress/dist "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 需要推送的本地目录")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("target-branch")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" master "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 推送的目标仓库分支")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("repo")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" shownoso/shownoso.github.io "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 推送的目标仓库")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("github_token")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" $GITHUB_TOKEN "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 用于允许 Travis 向你的仓库推送代码。在 GitHub 中生成，在 Travis 的项目设置页面进行配置")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("keep_history")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean important"}},[s._v("true")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("on")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("branch")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" master "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 本地项目的master分支")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br")])]),t("h3",{attrs:{id:"github-token"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#github-token"}},[s._v("#")]),s._v(" github_token")]),s._v(" "),t("p",[s._v("为了完成 "),t("code",[s._v("deploy")]),s._v(" 任务，Travis 需要获得一些必要权限，用于对 github 上仓库代码的拉取、推送等操作，因此，在 github 配置一个 "),t("code",[s._v("Personal access token")]),s._v("。")]),s._v(" "),t("ul",[t("li",[s._v("进入 github 主页点击个人头像，进入 Settings-Developer -> settings -> Personal access tokens 面板，点击 Generate new token 选择需要的权限并生成新的 token。")]),s._v(" "),t("li",[s._v("复制这个 token，回到 Travis 项目配置页，在 Environment Variables 中添加一个环境变量 "),t("code",[s._v("GITHUB_TOKEN")]),s._v("，值为该 token。")])]),s._v(" "),t("h2",{attrs:{id:"travis-客户端工具"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#travis-客户端工具"}},[s._v("#")]),s._v(" Travis 客户端工具")]),s._v(" "),t("ol",[t("li",[s._v("安装：")])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 本地环境为 Cent OS 7")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 安装 ruby 并更改 gem 源")]),s._v("\nyum "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" ruby\ngem sources --remove https://rubygems.org/\ngem sources -a https://gems.ruby-china.com\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# for centos7(Redhat) distro ")]),s._v("\nyum "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" ruby-devel \n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 更新 gem（按需）")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# gem update --system")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 安装 travis")]),s._v("\ngem "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" travis\n\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br")])]),t("ol",{attrs:{start:"2"}},[t("li",[s._v("登录")])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("travis login\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h3",{attrs:{id:"travis-加密"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#travis-加密"}},[s._v("#")]),s._v(" Travis 加密")]),s._v(" "),t("ol",[t("li",[s._v("加密一段文本"),t("br"),s._v("\n在 Environment Variables 中配置了环境变量 "),t("code",[s._v("GITHUB_TOKEN")]),s._v("，它的值在 Travis 网站是明文保存的。当不希望这样时，可以使用 "),t("code",[s._v("travis encrypt")]),s._v(" 对其进行加密使用。")])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 在本地项目的根目录下执行")]),s._v("\ntravis encrypt "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("GITHUB_TOKEN")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"token"')]),s._v(" --add\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("ul",[t("li",[s._v("GITHUB_TOKEN：环境变量名")]),s._v(" "),t("li",[s._v("token：github 中生成的的 "),t("code",[s._v("Personal access token")])]),s._v(" "),t("li",[s._v("--add：将输出自动添加到 "),t("code",[s._v(".travis.yml")])])]),s._v(" "),t("p",[s._v("在 "),t("code",[s._v(".travis.yml")]),s._v(" 使用加密文本，添加了一个环境变量")]),s._v(" "),t("div",{staticClass:"language-yml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("env")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("global")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("secure")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" TR0"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("...")]),s._v("zw=\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("ol",{attrs:{start:"2"}},[t("li",[s._v("加密一个文件"),t("br"),s._v("\n当希望 Travis 免密登录远程服务器时，可以使用 "),t("code",[s._v("travis encrypt-file")]),s._v(" 对服务器的私钥进行加密")])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 在本地项目根目录下，对私钥进行加密")]),s._v("\ntravis encrypt-file ~/.ssh/id_rsa --add\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("ul",[t("li",[s._v("将在项目根目录创建 id_rsa.enc")]),s._v(" "),t("li",[s._v("travis 会给出提示 将私钥加密后的 id_rsa.enc 提交到仓库而不是将私钥 id_rsa 本身提交到仓库")]),s._v(" "),t("li",[s._v("--add： 将输出自动添加到 "),t("code",[s._v(".travis.yml")]),s._v(" 中的 "),t("code",[s._v("before_install")])])]),s._v(" "),t("p",[s._v("在 "),t("code",[s._v(".travis.yml")]),s._v(" 使用密钥")]),s._v(" "),t("div",{staticClass:"language-yml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# --add生成的路径 （~\\/.ssh/id_rsa）添加了转义符")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 手动去除转义符 \\")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("before_install")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" openssl aes"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("256"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("cbc "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("K $encrypted_xxxxxxxxxxxx_key "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("iv $encrypted_xxxxxxxxxxxx_iv\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("in id_rsa.enc "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("out ~/.ssh/id_rsa "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("d\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 修改私钥权限以支持访问")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" chmod 600 ~/.ssh/id_rsa\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])]),t("ul",[t("li",[s._v("$encrypted_xxxxxxxxxxxx_key 和 $encrypted_xxxxxxxxxxxx_iv 在 Settings 面板中的 Environment Variables 配置中")]),s._v(" "),t("li",[s._v("Travis 在执行解密操作时，需要用到这两个环境变量")])]),s._v(" "),t("h2",{attrs:{id:"远程服务器示例"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#远程服务器示例"}},[s._v("#")]),s._v(" 远程服务器示例")]),s._v(" "),t("div",{staticClass:"language-yml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("language")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" node_js\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("node_js")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" lts/*\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("install")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" npm install\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("script")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" npm run docs"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("build\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("after_success")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" ssh $REMOTE_USER \"echo 'travis build done"),t("span",{pre:!0,attrs:{class:"token tag"}},[s._v("!'")]),s._v(' "\n'),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("before_install")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" openssl aes"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("256"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("cbc "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("K $encrypted_xxxxxxxxxxxx_key "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("iv $encrypted_xxxxxxxxxxxx_iv\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("in id_rsa.enc "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("out ~/.ssh/id_rsa "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("d\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" chmod 600 ~/.ssh/id_rsa\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("addons")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ssh_known_hosts")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" $REMOTE_IP\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("env")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("global")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("secure")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" WOt"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("...")]),s._v("9M=\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("secure")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" M3X"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("...")]),s._v("xc=\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("secure")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Pk8"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("...")]),s._v("/I=\n\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br")])]),t("h3",{attrs:{id:"使用-travis-访问远程服务器的注意点"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#使用-travis-访问远程服务器的注意点"}},[s._v("#")]),s._v(" 使用 Travis 访问远程服务器的注意点")]),s._v(" "),t("ol",[t("li",[s._v("Travis 进行免密登录时，需要增加一行 "),t("code",[s._v("- chmod 600 ~/.ssh/id_rsa")]),s._v(" 修改容器中私钥的访问权限。")]),s._v(" "),t("li",[s._v("第一次登录远程服务器会出现 SSH 主机验证，需要添加受信主机。")])]),s._v(" "),t("div",{staticClass:"language-yml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("addons")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ssh_known_hosts")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" your"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("ip\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[s._v("或者通过 "),t("code",[s._v("-o StrictHostKeyChecking=no")]),s._v(" 取消严格验证")]),s._v(" "),t("div",{staticClass:"language-yml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("after_success")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" ssh user@server "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v('o StrictHostKeyChecking=no "./deploy.sh"\n')])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("h2",{attrs:{id:"附录：travis-任务的生命周期"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#附录：travis-任务的生命周期"}},[s._v("#")]),s._v(" 附录：Travis 任务的生命周期")]),s._v(" "),t("ol",[t("li",[s._v("before_install 安装依赖前")]),s._v(" "),t("li",[s._v("install 安装依赖时")]),s._v(" "),t("li",[s._v("before_script 执行脚本前")]),s._v(" "),t("li",[s._v("script 执行脚本时")]),s._v(" "),t("li",[s._v("after_success 或 after_failure 执行脚本成功（失败）后")]),s._v(" "),t("li",[s._v("before_deploy 部署前")]),s._v(" "),t("li",[s._v("deploy 部署时")]),s._v(" "),t("li",[s._v("after_deploy 部署后")]),s._v(" "),t("li",[s._v("after_script 执行脚本后")])])])}),[],!1,null,null,null);a.default=e.exports}}]);